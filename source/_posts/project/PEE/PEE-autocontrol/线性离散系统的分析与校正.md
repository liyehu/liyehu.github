---
title: 线性离散系统的分析与校正
date: 2023-05-23 14:49:51
tags: autocontrol
categories:
    - project
    - PEE
top:
hidden:
---
&ensp;
<!-- more -->

# 离散系统
离散控制系统是指在控制系统的一处或输出信号为脉冲序列或数码的系统。

如果在系统中使用了采样开关，将连续信号变为脉冲序列去控制系统，则称此系统为采样控制系统。

如果在系统中采用了数字计算机或数字控制器，其信号是以数码形式传递的，则称此系统为数字控制系统。

通常把采样控制系统和数字控制系统统称为离散控制系统。

数字控制系统是一种以数字计算机为控制器去控制具有连续工作状态的被控对象的闭环控制系统。
因此，数字控制系统包括工作于离散状态下的数字计算机和工作于连续状态下的被控对象两大部分。
下图给出数字控制系统的原理框图

![](线性离散系统的分析与校正/数字控制系统.png)
<center>图1 数字控制系统原理框图</center>


图中计算机作为校正装置被引进系统，它只能接受时间上离散、数值上被量化的数码信号，而系统的被控量、给定量一般为连续的模拟信号。
因此，需要将偏差量$e(t)$进行离散化，再由A/D将每个离散点进行量化，转换成数码信号。然后进入计算机进行数字运算，输出的仍然是时间上离散、数值上量化的数码信号。数码信号不能直接作用于被控对象，因为在两个离散点之间是没有信号的，需要保持器补上输出信号值。
最简单的保持器为零阶保持器，它将前一个采样点的值一直保持到后一个采样点出现前。作用到被控对象上，数模转换和信号保持都由D/A完成。

当数字计算机字长足够长，转换精度够高，可忽略量化误差影响，近似认为转换有唯一对应关系。
此时，A/D相当于一个采样开关，D/A相当于一个保持器，又将计算机规律近似用传递函数加一个采样开关等效描述，这样可以得到下图的结构图


![](线性离散系统的分析与校正/计算机控制结构.png)
<center>图2 计算机控制结构图</center>


# 信号保持和采样

## 信号采样

在采样过程中，把连续信号转换成脉冲或数码序列的过程称作采样过程

实现采样的装置，叫做采样开关或采样器，如果采样开关以周期T时间闭环，并且闭合的时间为$\tau$，这样就一个连续函数$e(t)$就变成了一个断续的脉冲序列$e^*(t)$。
在实际过程中，采样开关闭合持续时间很短，可近似认为$\tau\approx0$，同时假设计算机字长足够长，忽略量化误差的影响，输入采样信号就是一串理想脉冲。可以得到其数学描述
$$
e^*(t)=e(0)\delta(t)+e(T)\delta(t-T)+\cdots+e(nT)\delta(t-nT)+\cdots
$$
或
$$
e^*(t)=e(t)\sum_{n=-\infty}^{\infty}\delta(t-nT)
$$

## 采样定理
如何将离散信号不失真恢复到原来的形状，这设计到采样频率如何选择的问题。
由于理想单位脉冲序列$\delta_T(t)$是周期函数，可以展开为复数形式傅里叶级数
$$
\delta_T(t)=\sum_{n=-\infty}^\infty c_ne^{jnw_st}
$$

其中$w_s=2\pi/T$，为采样角频率，T为采样周期，$c_n$是傅里叶级数系数，由下式确定
$$
c_n={1\over T}\int_{-T/2}^{T/2}\delta_T(t)e^{-jnw_st}dt
$$

由于$\delta_T(t)$在$t=0$时有值,所以有
$$
c_n={1\over T}\int_{0_-}^{0_+}\delta(t)dt={1\over T}
$$

将其带回去可得
$$
\delta_T(t)={1\over T}\sum_{n=-\infty}^{+\infty}e^{jnw_st}
$$
则有
$$
e^*(t)=e(t){1\over T}\sum_{n=-\infty}^{+\infty}e^{jnw_st}
={1\over T}\sum_{n=-\infty}^{+\infty}e(nT)e^{jnw_st}
$$


上式两边取拉普拉斯变换，由移位定理得
$$
E^*(s)={1\over T}\sum_{n=-\infty}^{+\infty}E(s+jnw_s)
$$

令s=jw，得

$$
E^*(jw)={1\over T}\sum_{n=-\infty}^{+\infty}E[j(w+nw_s)]
$$

其中，$E(jw)$为相应连续信号$e(t)$的傅里叶变换，$|E(jw)|$为$e(t)$频谱。一般来说，连续信号的带宽是有限的。，上式表明采样信号具有以采样频率为周期的无线频谱。
除了主频谱外，还包含无线多个附加的高频频谱分量，只不过复制上变化了$1/T$倍。
为了准确复现被采样信号，可用一个理想的低通滤波器滤掉全部附加的高频频谱分量，保留主频谱。
如果频谱中最高频率为$w_h$，则$e^*(t)$频谱不混叠的条件为
$$
w_s\geqslant2w_h\qquad 或\qquad T\leqslant{\pi\over w_h}
$$

即为香农采样定理，定理说明，当采样频率大于或等于信号所含最高频率两倍，才有可能通过理想滤波器，把信号完整恢复出来。

## 采样周期的选择

采样周期T是离散控制系统设计中的一个重要因素，采样定理只给出不产生频率混叠的T的最大值。
显然，T越小，获得控制控制过程的信息越多，控制效果也会越好。但是T过短也会增加不必要的计算负担，难以实现复杂的控制率。
反之，会给系统控制过程带来较大的误差，影响系统的动态性能，甚至导致系统不稳定。

从频率性能指标来看，控制系统的闭环频率响应通常具有低通滤波性，当随动系统输入信号的频率高于其闭环幅相特性的带宽时，信号通过系统会显著衰减。可以认为通过系统的控制信号最高频率分量为$w_b$。
一般随动系统的开环截止频率与闭环带宽频率比较接近，可以认为$w_c=w_b$，因此，可以认为超过$w_c$的频率分量通过系统将被大幅度衰减，根据工程经验有
$$
w_s=10w_c
$$

因此有
$$
T={\pi\over 5w_c}
$$

从时域性能指标来看，采样周期可根据阶跃响应的调节时间$t_s$，按下列经验公式有
$$
T={t_s\over 40}
$$

## 零阶保持器

为了控制被控对象，需要将数字计算器输出的离散信号回复成连续信号。但是理想滤波器实际上是不可实现的，因此，需要寻找在特性上接近理想滤波器，而物理上又可以实现的滤波器。

零阶保持器实现简单，是工程上常用的保持器。作用是把某时刻的采样值一直保持到下一个采样时刻，从而使采样信号$e^*(t)$变成阶梯信号$e_h(t)$，因为$e_h(t)$在每个采样周期内的导数为0，故称零阶保持器。
给零阶保持器输入一个理想脉冲$\delta(t)$则其单位脉冲响应函数$g_h(t)$是幅值为1，持续时间为T的矩形脉冲，它可分解为两个单位阶跃函数的和
$$
g_h(t)=1(t)-1(t-T)
$$

对脉冲响应函数$g_h(t)$取拉普拉斯变换，可得零阶保持器的传递函数
$$
G_h(s)={1\over s}-{e^{-Ts}\over s}
$$
令s=jw，得到零阶保持器的频率特性
$$
G_h(jw)={1-e^{-jwT}\over jw}={2e^{-jwT/2}(e^{jwT/2}-e^{-jwT/2})\over2jw}=T{\sin(wT/2)\over wT/2}e^{-jwT/2}
$$

若用$w_s=2\pi/T$来表示，则有
$$
G_h(jw)={2\pi\over w_s}{\sin\pi(w/w_s)\over\pi(w/w_s)}e^{-j\pi(w/w_s)}
$$

根据上式绘制零阶保持器的频率特性曲线

![](线性离散系统的分析与校正/零阶保持器频率.png)
<center>图3 零阶保持器频率特性</center>

由图可得，零阶保持器幅频特性的幅值随频率的增大而衰减，具有明显的低通滤波性，但与理想滤波器幅频特性相比，在$w=w_s/2$，其幅值只有初值的$63.7\%$，另外，零阶保持器除了允许主频分量通过外，还允许一部分高频分量通过。
从相频特性可以看出，零阶保持器会产生相角滞后，所以经过恢复以后所得到的连续信号$e_h(t)$和原有信号$e(t)$是有区别的。
如果把零阶保持器的输出阶梯信号的中点光滑连接起来，可以得到与连续信号形状一致但时间上滞后T/2的曲线。
所以粗略将，引入零阶保持器，相当于给系统增加了一个延迟环节，会使系统总的滞后角增大，对系统的稳定性不利，这与零阶保持器滞后特性是一致的。

# z变换
## z变换的定义
对采样信号的数学描述进行拉普拉斯变换有
$$
E^*(s)={\mathcal L[e^*(t)]}=\sum_{n=0}^{\infty}e(nT)
{\mathcal L}[\delta(t-nT)]=\sum_{n=0}^\infty e(nT)e^{-nTs}
$$


上式的$e^{-Ts}$是s的超越函数，直接运算不方便，为此引入变量
$$
z=e^{Ts}
$$

将其代回去，可得
$$
E(z)=E^*(s)|_{s={\ln z\over T}}=\sum_{n=0}^\infty e(nT)z^{-n}
$$

z变换定义式有明确的物理意义，即变量$z^{-n}$的系数代表连续时间函数$e(t)$在采样时刻$nT$上的采样值。


## z变换的方法

### 级数求和法

根据z变换的定义，将连续信号$e(t)$按周期T进行采样，将采样点的值代入，可得E(z)的级数展开式
$$
E(z)=e(0)+e(T)z^{-1}+e(2T)z^{-2}+\cdots+e(nT)z^{-n}+\cdots
$$
若有连续时间函数如下
$$
e(t)=
\begin{cases}
a^t,&t\geqslant0\\
0,&t<0
\end{cases}
$$

按周期T=1进行采样可得
$$
e(n)=
\begin{cases}
a^n,&n\geqslant0\\
0,&n<0
\end{cases}
$$

则有
$$
E(z)=\sum_{n=0}^\infty e(nT)z^{-n}=\sum_{n=0}^\infty(az^{-1})^n
$$


若$|z|>|a|$，则无穷级数是收敛的，利用等比求和公式有
$$
E(z)={1\over 1-az^{-1}}={z\over z-a}
$$


### 部分分式法
若连续信号的拉普拉斯变换可展开成部分分式之和，且每一部分都是z变换表中所对应的标准函数，即
$$
E(s)=E_1(s)+E_2(s)+\cdots+E_n(s)
$$

若有
$$
E(s)={s+2\over s^2(s+1)}
$$
则有
$$
E(s)={2\over s^2}-{1\over s}+{1\over s+1}
$$


查表可得

$$
E(z)={2Tz\over (z-1)^2}-{z\over z-1}+{z\over z-e^{-T}}
$$

### 留数法
若已知$E(s)$和它的全部极点$s_i$，可用下列留数计算公式计算采样序列的z变换

$$
E(z)=\sum_{I=1}^l[Res E(s){z\over z-e^{Ts}}]_{s\to s_i}
$$


若$s_i$为单极点
$$
Res[E(s){z\over z-e^{Ts}}]_{s\to s_i}
=\lim\limits_{s\to s_i}[(s-s_i)E(s){z\over z-e^{Ts}}]
$$

若$s_i$为m重极点
$$
Res[E(s){z\over z-e^{Ts}}]_{s\to s_i}=
{1\over (m-1)!}\lim\limits_{s\to s_i}{d^{m-1}\over ds^{m-1}}[(s-s_i)^mE(s){z\over z-e^{Ts}}]
$$


若有$E(s)=\displaystyle{s(2s+3)\over (s+1)^2(s+2)}$
，则$E(s)$的极点为-2，-1，其中-1为二重极点。则有
$$
E(z)=\lim\limits_{s\to-1}{d\over ds}[(s+1)^2{s(2s+3)\over(s+1)^2(s+2)}{z\over z-e^{Ts}}]+
\lim\limits_{s\to-2}[(s+2){s(2s+3)\over(s+1)^2(s+2)}{z\over z-e^{Ts}}]\\
={-Tze^{-T}\over z(z-e^{-T})^2}+{2\over z-e^{-2T}}
$$

## z变换基本定理
### 线性定理
若$E_1(z)=\mathcal Z[ e_1(t)],E_2(z)=\mathcal Z[ e_2(t)],a,b$为常数，则有
$$
\mathcal Z[ ae_1(t)\pm be_2(t)]=aE_1(z)\pm bE_2(z)
$$

### 实位移定理
如果函数$e(t)$是可以z变换的，则有滞后定理
$$
z[e(t-kT)]=z^{-k}E(z)
$$

以及超前定理
$$
z[e(t+kT)]=z^k[E(z)-\sum_{n=0}^{k-1}e(nT)z^{-n}]
$$


### 复位移定理

如果函数$e(t)$是z变换的，则有
$$
\mathcal Z[a^{\mp bt}e(t)]=E(za^{\pm bt})
$$

### 初值定理
设$e(t)$的z变换为$E(z)$，并存在极限$\lim\limits_{z\to\infty}E(z)$，则
$$
\lim\limits_{t\to0}e^*(t)=\lim\limits_{z\to\infty}E(z)
$$

### 终值定理
如果信号$e(t)$的z变换为$E(z)$，信号序列$e(nT)$为有限值。
$$
\lim\limits_{n\to\infty}e(nT)=\lim\limits_{z\to1}(z-1)E(z)
$$

## z反变换

### 幂级数法
设
$$
E(z)={10z\over (z-1)(z-2)}
$$
则有

![](线性离散系统的分析与校正/长除法.png)

变量$z^{-n}$的系数代表连续时间函数在$nT$时刻上的采样值。根据$z^{-n}$的系数便可以得出时间序列$e(nT)$的值。

### 部分分式法

根据已知的$E(z)$，通过查z变换表找出相应的$e^*(t)$，或者$e(nT)$。
考虑到z变换函数$E(z)$在其分子上都有因子z，所以通常线将$E(z)/z$展开成部分分式之和。

设
$$
E(z)={10z\over (z-1)(z-2)}
$$

那么
$$
{E(z)\over z}={-10\over z-1}+{10\over z-2}
$$
所以
$$
E(z)={-10z\over z-1}+{10z\over z-2}
$$

最后可得
$$
e^*(t)=\sum_{n=0}^\infty 10(2^n-1)\delta(t-nT)
$$

### 留数法
$E(z)$的幂级数展开形式为
$$
E(z)=\sum_{n=0}^\infty e(nT)z^{-n}
$$

设函数$E(z)z^{n-1}$除有限个极点$z_1,z_2,\cdots,z_k$外，在z域上是解析的，则有

$$
e(nT)=\sum_{i=1}^k Res[E(z)z^{n-1}]_{z\to z_i}
$$

其中，若$z_i$为单极点则有
$$
Res[E(z)z^{z-1}]_{z\to z_i}
=\lim\limits_{z\to z_i}[(z-z_i)E(z)z^{n-1}]
$$


若$z_i$为m重极点
$$
Res[E(z)z^{z-1}]_{z\to z_i}=\lim\limits_{z\to z_i}
{1\over (m-1)!}{\huge\{ }  {d^{m-1} \over dz^{m-1} }[(z-z_i)^m E(z)z^{n-1}] \huge\}
$$


若$E(z)=\displaystyle{z^3\over (z-1)(z-5)^2}$，则有

$$
Res[E(z)z^{n-1}]_{z\to 1}=
\lim\limits_{z\to 1}(z-1){z^{n+2}\over(z-1)(z-5)^2}=
{1\over 16}\\
Res[E(z)z^{n-1}]_{z\to 5}=
{d\over dz}[(z-5)^2{z^{n+2}\over (z-1)(z-5)^2}]=
{(4n+3)5^{n+1}\over 15}
$$

## z变换的局限性

z变换是研究线性定长离散系统的一种有效工具，但z变换也有其本身的局限性，使用时应注意其使用范围

1. 输出z变换函数$C(z)$只确定了时间函数$c(t)$在采样瞬时的值，而不能反映$c(t)$在采样点间的信息。
2. 用z变换法分析离散系统时，若在采样开关和系统连续部分传递函数$G(s)$之间有零阶保持器，则$G(s)$极点数**应**至少比其零点数多一个，反之，则**应**多两个，即 $G(s)$的脉冲响应在t=0时，必须没有跳跃，或者满足
$$
\lim\limits_{s\to\infty}sG(s)=0
$$
否则，用z变换法得到的系统采样输出$c^*(t)$与实际连续输出$c(t)$之间会有较大差别。

# 离散系统的数学模型

## 差分方程及其解法

### 差分的概念
设连续函数为$e(t)$，其采样函数为$e(kT)$简记为$e(k)$，则一阶前向差分定义为

$$
\Delta e(k)=e(k+1)-e(k)
$$

二阶前向差分定义为
$$
\Delta^2e(k)=\Delta[e(k+1)-e(k)]\\
=\Delta e(k+1)-\Delta e(k)\\=
e(k+2)-2e(k+1)+e(k)
$$

同理可得n阶前向差分定义为
$$
\Delta^n e(k)=\Delta^{n-1}e(k+1)-\Delta^{n-1}e(k)
$$

同理一阶后向差分定义为

$$
\nabla e(k)=e(k1)-e(k-1)
$$

二阶后向差分定义为

$$
\nabla^2e(k)=\nabla[e(k)-e(k-1)]\\
=\nabla e(k)-\nabla e(k-1)\\=
e(k)-2e(k-1)+e(k-2)
$$

同理可得n阶后向差分定义为
$$
\nabla^n e(k)=\nabla^{n-1}e(k)-\nabla^{n-1}e(k-1)
$$

### 离散系统的差分方程
对于连续系统而言，系统的数学模型可以用微分方程来表示。如果把离散序列$r(k),c(k)$看成连续系统的$r(t),c(t)$，那么可以得到离散系统的差分方程。
设系统采样周期为T，当T足够小时，函数$r(t)$在t=kT处的一阶导数近似为
$$
\.{r}(kT)\approx {r(kT)-r[(k-1)T]\over T}
$$
同理可以写出二阶导数
$$
\"{r}(k)\approx {r(k)-2r(k-1)+r(k-2)\over T^2}
$$

如此，可以一直写出n阶导数。

所以，离散系统的输入特性可用后向差分方程表示，其一般表达式为
$$
\sum_{i=0}^na_i c(k-i)=\sum_{j=0}^m b_jr(k-j)
$$

也可以用前向差分方程表示，其一般表达式为
$$
\sum_{i=0}^na_i c(k+i)=\sum_{j=0}^m b_jr(k+j)
$$

前向差分方程和后向差分方程并无本质区别，前向差分方程多用于描述非零初始条件的离散系统，若不考虑初始条件，就系统输入、输出关系而言，两者等价。


### 差分方程求解
#### 迭代法
迭代法是一种是一种递推方法，适合计算机递推运算求解。
若已知二阶连续系统的微分方程为
$$
\"c(t)-4\.c(t)+3c(t)=1(t)\\
c(t)=0\quad t\leqslant0
$$
现将其离散化，采样周期T=1，则有

$$
\Delta^2c(k)-4\Delta c(k)+3c(k)=c(k+2)-6(k+1)+8c(k)=1(k)\\
c(k+2)=6c(k+1)-8c(k)+1(k)
$$

根据上式的递推关系以及初始条件$c(k)=0\quad(k\leq0)$，可得到如下迭代
$$
k=-1:c(1)=6c(0)-8c(-1)+1(-1)=0\\
k=0:c(2)=6c(1)-8c(0)+1(0)=1\\
k=1:c(3)=6c(2)-8c(1)+1(1)=7\\
\vdots
$$


#### z变换法

对差分方程两端取z变换，并利用z变换的实数位移定理，得到以z为变量的代数方程，然后对代数方程的解取z反变换，可求得输出序列。
设二阶线性齐次差分方程为
$$
c(k+2)-2c(k+1)+c(k)=0\\
$$
设初始条件$c(0)=0,c(1)=1$

对上式进行z变换可得
$$
(z^2-2z+1)C(z)=z
$$

那么

$$
C(z)={z\over(z-1)^2}
$$

反变换可得
$$
c^*(t)=\sum_{n=0}^\infty nT\delta(t-nT)
$$

## 脉冲传递函数




